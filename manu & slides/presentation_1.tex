%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer Presentation
% LaTeX Template
% Version 1.0 (10/11/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------

\documentclass{beamer}
\usepackage{graphicx}
\graphicspath{ {/Users/wenxuandeng/GoogleDrive/sucksalt/group_lasso/code/GroupLasso/manu & slides} }

\mode<presentation> {

% The Beamer class comes with a number of default slide themes
% which change the colors and layouts of slides. Below this is a list
% of all the themes, uncomment each in turn to see what they look like.

%\usetheme{default}
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
%\usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{Dresden}
%\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
%\usetheme{Ilmenau}
%\usetheme{JuanLesPins}
%\usetheme{Luebeck}
\usetheme{Madrid}
%\usetheme{Malmoe}
%\usetheme{Marburg}
%\usetheme{Montpellier}
%\usetheme{PaloAlto}
%\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Singapore}
%\usetheme{Szeged}
%\usetheme{Warsaw}

% As well as themes, the Beamer class has a number of color themes
% for any slide theme. Uncomment each of these in turn to see how it
% changes the colors of your current slide theme.

%\usecolortheme{albatross}
%\usecolortheme{beaver}
%\usecolortheme{beetle}
%\usecolortheme{crane}
%\usecolortheme{dolphin}
%\usecolortheme{dove}
%\usecolortheme{fly}
%\usecolortheme{lily}
%\usecolortheme{orchid}
%\usecolortheme{rose}
%\usecolortheme{seagull}
%\usecolortheme{seahorse}
%\usecolortheme{whale}
%\usecolortheme{wolverine}

%\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
%\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line

%\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}

\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title[Patient Subgroup Selection]{Generalized Group Lasso for Patient Subgroup Selection} % The short title appears at the bottom of every slide, the full title is only on the title page

\author{Wenxuan Deng} % Your name
\institute[Takeda] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
Takeda Pharmaceuticals U.S.A., Inc. \\ % Your institution for the title page
\medskip
\textit{Wenxuan.Deng@takeda.com} % Your email address
}
\date{\today} % Date, can be changed to a custom date

\begin{document}

\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

\begin{frame}
\frametitle{Overview} % Table of contents slide, comment this block out to remove it
\tableofcontents % Throughout your presentation, if you choose to use \section{} and \subsection{} commands, these will automatically be printed on this slide as an overview of your presentation
\end{frame}

%----------------------------------------------------------------------------------------
%	PRESENTATION SLIDES
%----------------------------------------------------------------------------------------

%------------------------------------------------
\section{Introduction} % Sections can be created in order to organize your presentation into discrete blocks, all sections and subsections are automatically printed in the table of contents as an overview of the talk
%------------------------------------------------

\subsection{Prognostic and Predictive Biomarkers} % A subsection can be created just before a set of slides with a common theme to further break down your presentation into chunks

\begin{frame}
\frametitle{Prognostic Biomarkers}

\begin{figure}
    \includegraphics[width=0.475\textwidth]{prognostic.jpg}
    \hfill
    \includegraphics[width=0.475\textwidth]{prognostic2.jpg}
 \end{figure}

\end{frame}


\begin{frame}
\frametitle{Predictive Biomarkers}

\begin{figure}
    \includegraphics[width=0.475\textwidth]{predictive3.jpg}
    \hfill
    \includegraphics[width=0.475\textwidth]{predictive4.jpg}
 \end{figure}

\end{frame}


%------------------------------------------------


\subsection{Why not regression trees?}

\begin{frame}
\frametitle{Tree-based Methods}

Regression trees GUIDE\cite{loh}:

\begin{itemize}
    \item piecewise-linear Model
    \item examine residual patterns for each treatment level
\end{itemize}

Cannot repeat even the most naive simulation in GUIDE paper.\\~

Reason: limited sample size. Even two splits will results in small sample size in each branch. The results would be highly unstable. Tree-based method is not appropriate
to clinical trial dataset and identify prognostic and predictive biomarkers.

\end{frame}

\section{Methods}

\begin{frame}
\frametitle{Ordinary Linear Model}

$$Y=X\beta + W\tau + G\alpha + W\otimes G \gamma+\epsilon$$

\begin{itemize}
    \item $X$: Baseline variables
    \item $W$: Treatment variables
    \item $G$: Main effects of genes, i.e. expression levels, SNP or mutation
    \item $W\otimes G$: Interaction effects of genes and treatment
    \item $\epsilon$: Random errors
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Group lasso}

We choose group lasso for its ability to 

\begin{itemize}
    \item handle high dimensional data
    \item allow hierarchical structure
\end{itemize}

However, the current group lasso based methods

\begin{itemize}
    \item penalize on all parameters
    \item have no efficient adaptive penalty weights
    \item do not specifically target on patients treatment subgroup identification
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Loss Function}

We assume the hierarchical relationship between prognostic biomarkers and predictive biomarkers, 
that is a predictive biomarker should be a prognostic biomarker.\\~
The loss function is

$$\min_{\theta} f(\theta|Y,X,W,G) + \lambda \sum_i \eta_i^I |\gamma_i| + \lambda \sum_i \eta_i^M \sqrt{\alpha_i^2 + \gamma_i^2}$$

where $f(\theta|Y,X,W,G)$ is L-2 loss function, i.e. sum of squared errors for ordinary linear model.\\~

$\theta=(\beta, \tau, \alpha, \gamma)$ is parameter vector.



\end{frame}

\begin{frame}
\frametitle{Loss function for ordinary linear model}

$$\min_{\theta} \parallel Y-(X\beta + W\tau + G\alpha + W\otimes G \gamma) \parallel^2 + \lambda \sum_i \eta_i^I |\gamma_i| + \lambda \sum_i \eta_i^M \sqrt{\alpha_i^2 + \gamma_i^2}$$

Denote $X^{(l)}_I=W\otimes G_l$, and $X^{(l)}=[G_l,X^{(l)}_I]$ is the $l$th group of the main and interaction effects of gene $l$.
Thus, due to KKT conditions,  we let $$\eta_i^I=\parallel X^{(i)}\parallel_2$$
$$\eta_i^M = \sqrt{\parallel G_i\parallel_2^2 + 2(1-\sqrt{\frac{2}{\pi}})\parallel X_I^{(i)}}$$
\end{frame}


\section{Algorithm}



\section{Criteria}

\section{Simulation}



%------------------------------------------------






%------------------------------------------------

\begin{frame}
\frametitle{References}
\footnotesize{
\begin{thebibliography}{99} % Beamer does not support BibTeX so references must be inserted manually as below
\bibitem[Loh, 2018]{loh} Loh, Wei‚ÄêYin, Michael Man, and Shuaicheng Wang.  
\newblock "Subgroups from regression trees with adjustment for prognostic effects and postselection inference."
\newblock \emph{Statistics in medicine} (2018).
\end{thebibliography}
}
\end{frame}

%------------------------------------------------

\begin{frame}
\Huge{\centerline{The End}}
\end{frame}

%----------------------------------------------------------------------------------------

\end{document} 